<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="User-friendly dashboard for MGNREGA employment data in Goa state. Track rural employment, families helped, and funds spent."
        />
        <meta
            name="keywords"
            content="MGNREGA, Goa, rural employment, dashboard, government, jobs, families"
        />
        <meta name="author" content="Government of Goa" />

        <!-- Cache Control -->
        <meta
            http-equiv="Cache-Control"
            content="no-cache, no-store, must-revalidate"
        />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta http-equiv="Expires" content="0" />

        <!-- Open Graph Meta Tags -->
        <meta property="og:title" content="MGNREGA Goa Dashboard" />
        <meta
            property="og:description"
            content="Track rural employment and development in Goa"
        />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://mgnrega-goa.gov.in" />
        <meta property="og:image" content="/og-image.png" />

        <!-- Twitter Card Meta Tags -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="MGNREGA Goa Dashboard" />
        <meta
            name="twitter:description"
            content="Track rural employment and development in Goa"
        />
        <meta name="twitter:image" content="/twitter-image.png" />

        <!-- Favicon -->
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="icon" type="image/png" href="/favicon.png" />
        <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

        <!-- Theme Color -->
        <meta name="theme-color" content="#15803d" />
        <meta name="msapplication-TileColor" content="#15803d" />

        <!-- Preconnect to optimize font loading -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

        <!-- Google Fonts - Inter for better readability -->
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
            rel="stylesheet"
        />

        <!-- Manifest disabled for development -->

        <!-- Security Headers -->
        <meta http-equiv="X-Content-Type-Options" content="nosniff" />
        <meta http-equiv="X-XSS-Protection" content="1; mode=block" />

        <!-- Title -->
        <title>MGNREGA Goa Dashboard - Rural Employment Tracker</title>

        <!-- Inline critical CSS for faster loading -->
        <style>
            /* Critical CSS for immediate rendering */
            * {
                box-sizing: border-box;
            }

            html {
                font-family:
                    "Inter",
                    -apple-system,
                    BlinkMacSystemFont,
                    "Segoe UI",
                    Roboto,
                    sans-serif;
                line-height: 1.5;
                -webkit-text-size-adjust: 100%;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            body {
                margin: 0;
                padding: 0;
                min-height: 100vh;
                background-color: #f9fafb;
                color: #111827;
                font-size: 16px;
            }

            #root {
                min-height: 100vh;
                display: flex;
                flex-direction: column;
            }

            /* Loading spinner styles */
            .loading-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                padding: 2rem;
            }

            .loading-spinner {
                width: 40px;
                height: 40px;
                border: 3px solid #e5e7eb;
                border-top: 3px solid #15803d;
                border-radius: 50%;
                animation: spin 1s linear infinite;
            }

            .loading-text {
                margin-top: 1rem;
                font-size: 1.125rem;
                font-weight: 500;
                color: #6b7280;
                text-align: center;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            /* Error fallback styles */
            .error-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                padding: 2rem;
                text-align: center;
            }

            .error-icon {
                font-size: 4rem;
                color: #dc2626;
                margin-bottom: 1rem;
            }

            .error-title {
                font-size: 1.5rem;
                font-weight: 600;
                color: #111827;
                margin-bottom: 0.5rem;
            }

            .error-message {
                color: #6b7280;
                margin-bottom: 2rem;
            }

            .error-button {
                background-color: #15803d;
                color: white;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 0.5rem;
                font-weight: 500;
                cursor: pointer;
                transition: background-color 0.2s;
            }

            .error-button:hover {
                background-color: #166534;
            }

            /* Skip to content link for accessibility */
            .skip-to-content {
                position: absolute;
                top: -40px;
                left: 6px;
                background: #15803d;
                color: white;
                padding: 8px;
                text-decoration: none;
                border-radius: 4px;
                z-index: 1000;
                font-weight: 500;
            }

            .skip-to-content:focus {
                top: 6px;
            }

            /* High contrast mode support */
            @media (prefers-contrast: high) {
                body {
                    background-color: white;
                    color: black;
                }

                .loading-spinner {
                    border-color: #000;
                    border-top-color: #15803d;
                }
            }

            /* Reduced motion support */
            @media (prefers-reduced-motion: reduce) {
                .loading-spinner {
                    animation: none;
                }
            }

            /* Print styles */
            @media print {
                body {
                    background: white;
                    color: black;
                }

                .loading-container,
                .error-container {
                    display: none;
                }
            }
        </style>
    </head>
    <body>
        <!-- Skip to content link for screen readers -->
        <a href="#main-content" class="skip-to-content">Skip to main content</a>

        <!-- Main React app container -->
        <div id="root">
            <!-- Loading fallback shown while JavaScript loads -->
            <div class="loading-container" id="loading-fallback">
                <div
                    class="loading-spinner"
                    role="status"
                    aria-label="Loading"
                ></div>
                <div class="loading-text">Loading MGNREGA Goa Dashboard...</div>
            </div>
        </div>

        <!-- Error fallback (hidden by default) -->
        <div class="error-container" id="error-fallback" style="display: none">
            <div class="error-icon" role="img" aria-label="Error">⚠️</div>
            <h1 class="error-title">Something went wrong</h1>
            <p class="error-message">
                We're having trouble loading the dashboard. Please check your
                internet connection and try again.
            </p>
            <button class="error-button" onclick="window.location.reload()">
                Reload Page
            </button>
        </div>

        <!-- Service Worker disabled for development -->
        <script>
            // Service worker registration completely disabled
            console.log("Service worker registration disabled in development");

            // Error handling for failed JavaScript loading
            window.addEventListener("error", (event) => {
                console.error("Global error:", event.error);
                showErrorFallback();
            });

            // Handle unhandled promise rejections
            window.addEventListener("unhandledrejection", (event) => {
                console.error("Unhandled promise rejection:", event.reason);
                showErrorFallback();
            });

            function showErrorFallback() {
                const loading = document.getElementById("loading-fallback");
                const error = document.getElementById("error-fallback");

                if (loading) loading.style.display = "none";
                if (error) error.style.display = "flex";
            }

            // Hide loading spinner once React takes over
            function hideLoadingFallback() {
                const loading = document.getElementById("loading-fallback");
                if (loading) {
                    loading.style.display = "none";
                }
            }

            // Analytics (if needed in production)
            // (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            // (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            // m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            // })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
            // ga('create', 'UA-XXXXXXXXX-X', 'auto');
            // ga('send', 'pageview');
        </script>

        <!-- Main application script -->
        <script type="module" src="/src/main.jsx?v=20241221-new"></script>

        <!-- Polyfills for older browsers (loaded conditionally) -->
        <script>
            // Load polyfills only if needed
            if (!window.IntersectionObserver) {
                const script = document.createElement("script");
                script.src =
                    "https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver";
                document.head.appendChild(script);
            }
        </script>
    </body>
</html>
